<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="hr_holidays.hr_leave_rule_employee_update" model="ir.rule">
        <field name="name">Time Off base.group_user create/write</field>
        <field name="model_id" ref="hr_holidays.model_hr_leave"/>
        <field name="domain_force">[
            ('holiday_type', '=', 'employee'),
            '|',
            '&amp;',
            ('employee_id.user_id', '=', user.id),
            ('state', 'not in', ['validate', 'validate1']),
            '&amp;',
            ('validation_type', 'in', ['manager', 'both', 'no_validation']),'|',
            ('employee_id.leave_manager_id', '=', user.id),('employee_id.department_id.delegated_manager_id', '=', user.id)]</field>
        <field name="perm_read" eval="False"/>
        <field name="perm_unlink" eval="False"/>
        <field name="groups" eval="[(4,ref('base.group_user'))]"/>
    </record>

    <record id="hr_holidays.hr_leave_rule_responsible_read" model="ir.rule">
        <field name="name">Time Off Responsible read</field>
        <field name="model_id" ref="hr_holidays.model_hr_leave"/>
        <field name="domain_force">['|',
            ('employee_id.leave_manager_id', '=', user.id),('employee_id.department_id.delegated_manager_id', '=', user.id)]</field>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
        <field name="groups" eval="[(4, ref('hr_holidays.group_hr_holidays_responsible'))]"/>
    </record>

    <record id="hr_holidays.hr_leave_rule_responsible_update" model="ir.rule">
        <field name="name">Time Off Responsible create/write</field>
        <field name="model_id" ref="hr_holidays.model_hr_leave"/>
        <field name="domain_force">[
            ('holiday_type', '=', 'employee'),
            '|',
            '&amp;',
            ('employee_id.user_id', '=', user.id),
            ('state', '!=', 'validate'),'|',
            ('employee_id.leave_manager_id', '=', user.id),('employee_id.department_id.delegated_manager_id', '=', user.id)]</field>
        <field name="perm_read" eval="False"/>
        <field name="perm_unlink" eval="False"/>
        <field name="groups" eval="[(4, ref('hr_holidays.group_hr_holidays_responsible'))]"/>
    </record>

    <record id="hr_holidays.hr_leave_allocation_rule_employee" model="ir.rule">
        <field name="name">Allocations: employee: read own</field>
        <field name="model_id" ref="hr_holidays.model_hr_leave_allocation"/>
        <field name="domain_force">[
            '|','|',
            ('employee_id.leave_manager_id', '=', user.id),
            ('employee_id.user_id', '=', user.id),('employee_id.department_id.delegated_manager_id', '=', user.id)]</field>
        <field name="perm_create" eval="False"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_unlink" eval="False"/>
        <field name="groups" eval="[(4,ref('base.group_user'))]"/>
    </record>

    <record id="hr_holidays.hr_leave_allocation_rule_employee_update" model="ir.rule">
        <field name="name">Allocations: base.group_user create/write</field>
        <field name="model_id" ref="hr_holidays.model_hr_leave_allocation"/>
        <field name="domain_force">[
            ('holiday_status_id.allocation_type', '=', 'fixed_allocation'),
            ('holiday_type', '=', 'employee'),
            '|',
            '&amp;',
            ('employee_id.user_id', '=', user.id),
            ('state', 'not in', ['validate', 'validate1']),
            '&amp;',
            ('validation_type', 'in', ['manager', 'both']),'|',
            ('employee_id.leave_manager_id', '=', user.id),('employee_id.department_id.delegated_manager_id', '=', user.id)]</field>
        <field name="perm_read" eval="False"/>
        <field name="perm_unlink" eval="False"/>
        <field name="groups" eval="[(4,ref('base.group_user'))]"/>
    </record>

    <record id="hr_leave_allocation_search_view_inherit" model="ir.ui.view">
        <field name="name">hr.leave.allocation.search.inherit</field>
        <field name="model">hr.leave.allocation</field>
        <field name="inherit_id" ref="hr_holidays.view_hr_leave_allocation_filter"/>
        <field name="arch" type="xml">
            <xpath expr="/search//filter[@name='managed_people']" position="replace">
                <filter string="People I Manage" name="managed_people" domain="[('employee_id.leave_manager_id', '=', uid),('employee_id.department_id.delegated_manager_id', '=', uid)]" help="Time off of people you are manager of"/>
<!--                <filter string="People I Manage" name="managed_people" domain="[('employee_id.leave_manager_id', '=', uid)]" help="Time off of people you are manager of"/>-->
            </xpath>
        </field>
    </record>
    <record id="hr_leave_search_view_inherit" model="ir.ui.view">
        <field name="name">hr.leave.search.inherit</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.view_hr_holidays_filter"/>
        <field name="arch" type="xml">
            <xpath expr="/search//filter[@name='managed_people']" position="replace">
                <filter string="People I Manage" name="managed_people" domain="['|',('employee_id.leave_manager_id', '=', uid),('employee_id.department_id.delegated_manager_id', '=', uid)]" help="Time off of people you are manager of"/>
<!--                <filter string="People I Manage" name="managed_people" domain="['|',('employee_id.leave_manager_id', '=', uid)]" help="Time off of people you are manager of"/>-->
            </xpath>
        </field>
    </record>
</odoo>